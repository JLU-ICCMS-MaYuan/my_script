# Bader电荷转移计算步骤

参考教程：
    1. https://zhuanlan.zhihu.com/p/379222933
    2. http://bbs.keinsci.com/thread-14725-1-1.html

**Bader 只支持PAW 的方法，需要vasp4.6.31 以及以上版本。**

## 1. 将结构优化后的CONTCAR保存为POSCAR后，在INCAR里面设置如下参数：

```shell
LAECHG=.TRUE. 
LCHARG = .TRUE.
NSW = 0 
```

## 2. 直接计算

```shell
bader CHGCAR
# 输出文件包括:
ACF.dat、BCF.dat、AtomVolumes.dat。
```

## 3. 精确计算

```shell
# 自洽完成后生成文件 AECCAR0、AECCAR1、AECCAR2
./chgsum.pl AECCAR0 AECCAR2
# 总的电荷将写入CHGCAR_sum
./bader CHGCAR -ref CHGCAR_sum
# 生成 ACF.dat AVF.dat BCF.dat，ACF.dat 就包含价电子的电荷信息。

```
**最后需要注意的是，我们需要一个精细的fft网格来精确地重现正确的总的核电荷，因此必须做一些计算以测试NG(X,Y,Z)F方案的可靠性，直到总电荷是正确为止。一般情况下，使用默认的FFT网格设置不会出现问题。**

## 4. 输出文件说明：
ACF.dat是包含价电子的电荷信息，一般都是查看此文件的结果。

```shell
# 第一列，是原子的序号，这和POSCAR中原子的顺序一致
# 每个原子的电荷大小是CHARGE这一列所对应的数值,这是原子价层电子中的电子总数。我们想要分析原子得失电子的情况，则需要减去计算所用的赝势（POTCAR）中的电子数。
    #         X           Y           Z       CHARGE      MIN DIST   ATOMIC VOL
 --------------------------------------------------------------------------------
    1    0.000000    2.649994    0.000000    9.669372     1.324792    13.306962
    2    0.000000    0.000000    2.648941    9.284710     1.223529    10.275785
    3    2.649627    2.649994    2.648941   10.616782     1.307204    12.797159
    4    2.649627    0.000000    0.000000   10.268028     1.342917    13.902519
    5    0.000000    0.000000    0.000000    2.446506     0.539705     1.329432
    6    0.000000    2.649994    2.648941    2.454253     0.544140     1.344788
    7    2.649627    0.000000    2.648941    2.451474     0.544140     1.348331
    8    2.649627    2.649994    0.000000    2.449856     0.544155     1.352820
    9    4.505807    4.505276    4.477654    1.434448     0.681443     3.045941
   10    0.793447    0.794712    0.820229    1.367030     0.681443     2.851871
   11    0.793447    0.794712    4.477654    1.387744     0.681443     2.910104
   12    4.505807    4.505276    0.820229    1.413735     0.681443     2.987709
   13    0.793447    4.505276    0.820229    1.390643     0.681443     2.919436
   14    4.505807    0.794712    4.477654    1.410835     0.681443     2.978377
   15    4.505807    0.794712    0.820229    1.390122     0.681443     2.920144
   16    0.793447    4.505276    4.477654    1.411356     0.681443     2.977668
   17    4.484409    1.842684    1.867159    1.405057     0.657296     3.011923
   18    0.814845    3.457304    3.430724    1.337661     0.657296     2.815491
   19    0.814845    3.457304    1.867159    1.361987     0.657296     2.885772
   20    4.484409    1.842684    3.430724    1.380731     0.657296     2.941642
   21    0.814845    1.842684    3.430724    1.358919     0.657296     2.875850
   22    4.484409    3.457304    1.867159    1.383799     0.657296     2.951564
   23    4.484409    3.457304    3.430724    1.359474     0.657296     2.881283
   24    0.814845    1.842684    1.867159    1.383244     0.657296     2.946131
   25    1.832625    4.484187    1.857072    1.417345     0.666787     3.004245
   26    3.466629    0.815801    3.440811    1.351266     0.666787     2.813365
   27    3.466629    0.815801    1.857072    1.374340     0.666787     2.881165
   28    1.832625    4.484187    3.440811    1.394270     0.666787     2.936445
   29    3.466629    4.484187    3.440811    1.373300     0.666787     2.877858
   30    1.832625    0.815801    1.857072    1.395311     0.666787     2.939752
   31    1.832625    0.815801    3.440811    1.372237     0.666787     2.871952
   32    3.466629    4.484187    1.857072    1.396374     0.666787     2.945658
   33    1.845576    1.846823    4.470031    1.419823     0.685164     2.959596
   34    3.453678    3.453165    0.827852    1.357124     0.685164     2.782181
   35    3.453678    3.453165    4.470031    1.377003     0.685164     2.838878
   36    1.845576    1.846823    0.827852    1.399945     0.685164     2.902899
   37    3.453678    1.846823    0.827852    1.378322     0.685164     2.843012
   38    1.845576    3.453165    4.470031    1.398626     0.685164     2.898765
   39    1.845576    3.453165    0.827852    1.378748     0.685164     2.842068
   40    3.453678    1.846823    4.470031    1.398200     0.685164     2.899710
 --------------------------------------------------------------------------------
    VACUUM CHARGE:               0.0000
    VACUUM VOLUME:               0.0000
    NUMBER OF ELECTRONS:        94.0000

```

## 5. 处理ACF.dat文件:
```shell
### 执行命令
python analybader.py   La 1 11   Y 1 11   Ce 1 12   Th 1 12   Be 4 4   H 32 1
参数的顺序是: 元素名 原子个数 价电子数
```